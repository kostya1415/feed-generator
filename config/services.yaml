parameters:
  app.env: '%env(APP_ENV)%'

services:
  _defaults:
    autowire: true
    autoconfigure: true
    bind:
      $env: '%app.env%'

  App\:
    resource: '../src/'
    exclude:
      - '../src/DependencyInjection/'
      - '../src/Entity/'
      - '../src/Kernel.php'

  App\Repository\Contract\OffersRepoInterface: '@App\Repository\HttpOffersRepo'

  App\Repository\Contract\FileRepoInterface: '@App\Repository\MinioFileRepo'

  Aws\S3\S3Client:
    arguments:
      - version: 'latest'
        region: 'me-south-1'
        endpoint: '%env(MINIO_SERVER)%'
        use_path_style_endpoint: true
        credentials:
          key: '%env(MINIO_ACCESS_KEY)%'
          secret: '%env(MINIO_SECRET_KEY)%'

  App\Repository\MinioFileRepo:
    arguments:
      $isBucketPolicySupported: '%env(bool:S3_IS_BUCKET_POLICY_SUPPORTED)%'
      $basketName: '%env(S3_BASKET_NAME)%'

  App\Action\FeedGzipAction:
    arguments:
      $feedNamesStr:
        - 'example'
        # todo

  App\Action\FeedZipAction:
    arguments:
      $feedNamesStr:
        - 'example2'
        # todo

  App\Render\ExampleRender:
    arguments:
      $siteUrl:
        '%env(SITE_URL)%'
  App\Render\Example2Render:
    arguments:
      $siteUrl:
        '%env(SITE_URL)%'

  App\Action\MakeFeedAction:
    arguments:
      $siteUrl: '%env(SITE_URL)%'
      $offerLimit: '%env(int:OFFERS_PER_PAGE_LIMIT)%'

  GuzzleHttp\Client: